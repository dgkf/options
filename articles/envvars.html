<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="options">
<title>Environment Variables • options</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Environment Variables">
<meta property="og:description" content="options">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">options</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/options.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/envvars.html">Environment Variables</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dgkf/options/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Environment Variables</h1>
            <h3 data-toc-skip class="subtitle">Customizing environment
variable handling</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dgkf/options/blob/HEAD/vignettes/envvars.Rmd" class="external-link"><code>vignettes/envvars.Rmd</code></a></small>
      <div class="d-none name"><code>envvars.Rmd</code></div>
    </div>

    
    
<p>Environment variables can be a tremendously helpful alternative to
options for behaviors that one might want to handle ubiquitously across
R sessions, that might be administered, or that might be needed in a
command-line context.</p>
<p>They can provide a helpful interface for supporting tasks that might
be called during continuous integration jobs, on a compute cluster, or
within a containerized environment. Since use cases can be hard to
predict, <code>options</code> will consider appropriately named
environment variables by default.</p>
<div class="section level2">
<h2 id="customizing-names">Customizing names<a class="anchor" aria-label="anchor" href="#customizing-names"></a>
</h2>
<p>Perhaps the default environment names don’t suit you. When defining
your options, you can always use your own! However, this level of
customization is only available through the <code><a href="../reference/defining_options.html">define_option()</a></code>
interface.</p>
<blockquote>
<p>By default environment variables look like
<code>R_&lt;PACKAGE&gt;_&lt;OPTION&gt;</code></p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dgkf.github.io/options/" class="external-link">options</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/defining_options.html">define_option</a></span><span class="op">(</span></span>
<span>  <span class="st">"volume"</span>,</span>
<span>  default <span class="op">=</span> <span class="st">"shout"</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Print output in uppercase ('shout') or lowercase ('whisper')"</span>,</span>
<span>  option_name <span class="op">=</span> <span class="st">"volume"</span>,</span>
<span>  envvar_name <span class="op">=</span> <span class="st">"VOL"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold; font-style: italic;">volume</span> = <span style="color: #0000BB; font-style: italic;">"shout"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Print output in uppercase ('shout') or lowercase ('whisper')</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  <span style="color: #555555;"> </span>option <span style="color: #555555;"> : </span><span style="color: #00BBBB;">volume</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;"> </span>envvar <span style="color: #555555;"> : </span><span style="color: #00BBBB;">VOL</span> (evaluated if possible, raw string otherwise)</span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">*</span><span style="color: #00BB00;">default</span><span style="color: #555555;"> : </span>"shout"</span></span>
<span></span>
<span><span class="va">twist_and</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">what</span> <span class="op">=</span> <span class="fu"><a href="../reference/opt.html">opt</a></span><span class="op">(</span><span class="st">"volume"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lyric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>    <span class="st">"Well, shake it up, baby, now (Shake it up, baby)"</span>,</span>
<span>    <span class="st">"Twist and shout (Twist and shout)"</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\n"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="kw">if</span> <span class="op">(</span><span class="va">what</span> <span class="op">==</span> <span class="st">"shout"</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">lyric</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">lyric</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">twist_and</span><span class="op">(</span><span class="op">)</span>  <span class="co"># by default, "shout"</span></span>
<span><span class="co">#&gt; WELL, SHAKE IT UP, BABY, NOW (SHAKE IT UP, BABY)</span></span>
<span><span class="co">#&gt; TWIST AND SHOUT (TWIST AND SHOUT)</span></span></code></pre></div>
<p>We can now alter our behavior using the environment variable,
<code>VOL</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>VOL <span class="op">=</span> <span class="st">"whisper"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">twist_and</span><span class="op">(</span><span class="op">)</span>  <span class="co"># picks up our environment variable, "whisper"</span></span>
<span><span class="co">#&gt; well, shake it up, baby, now (shake it up, baby)</span></span>
<span><span class="co">#&gt; twist and shout (twist and shout)</span></span></code></pre></div>
<p>That’s better!</p>
</div>
<div class="section level2">
<h2 id="setting-naming-rules">Setting Naming Rules<a class="anchor" aria-label="anchor" href="#setting-naming-rules"></a>
</h2>
<p>Although individually mapping options to environment variables is
handy for one-off options, it can be tedious to do throughout your
package, especially if you want all your variables to follow some
consistent naming scheme.</p>
<p>For this we can provide a function which is used to name all future
options’ environment variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/naming.html">set_envvar_name_fn</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">package</span>, <span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[^A-Z0-9]"</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">package</span>, <span class="st">"_"</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Now any future option environment variables will use this convention
when they are defined. Existing options will be unaffected until they
are redefined, so it’s often best to make sure this code runs before you
start defining options.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/defining_options.html">define_options</a></span><span class="op">(</span></span>
<span>  <span class="st">"Print output in uppercase ('shout') or lowercase ('whisper')"</span>,</span>
<span>  volume <span class="op">=</span> <span class="st">"shout"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold; font-style: italic;">volume</span> = <span style="color: #0000BB; font-style: italic;">"shout"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Print output in uppercase ('shout') or lowercase ('whisper')</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  <span style="color: #555555;"> </span>option <span style="color: #555555;"> : </span><span style="color: #00BBBB;">globalenv.volume</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;"> </span>envvar <span style="color: #555555;"> : </span><span style="color: #00BBBB;">GLOBALENV_VOLUME</span> (evaluated if possible, raw string otherwise)</span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">*</span><span style="color: #00BB00;">default</span><span style="color: #555555;"> : </span>"shout"</span></span></code></pre></div>
<p>You’ll notice that our redefined option now uses our custom naming
scheme for its environment variable.</p>
<p>You can always write your own function, or choose from some of the
pre-built ones in <code><a href="../reference/naming_formats.html">?naming_formats</a></code>.</p>
</div>
<div class="section level2">
<h2 id="parsing-values">Parsing Values<a class="anchor" aria-label="anchor" href="#parsing-values"></a>
</h2>
<p>So far we’ve just been using the environment variable’s value as-is.
Environment variable values, by default, will try to be parsed into R
objects. If that fails, they’ll deliver the raw string value.</p>
<p>This can be a nice default behavior, handling many simple cases as
expected</p>
<table class="table">
<colgroup>
<col width="49%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Environment Variable</th>
<th>Default <code>options</code> value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>whisper</code></td>
<td>
<code>[1] "whisper"</code> (<em>character</em>)</td>
</tr>
<tr class="even">
<td><code>"shout"</code></td>
<td>
<code>[1] "shout"</code> (<em>character</em>)</td>
</tr>
<tr class="odd">
<td><code>12345</code></td>
<td>
<code>[1] 12345</code> (<em>numeric</em>)</td>
</tr>
<tr class="even">
<td><code>TRUE</code></td>
<td>
<code>[1] TRUE</code> (<em>logical</em>)</td>
</tr>
<tr class="odd">
<td><code>NULL</code></td>
<td><code>NULL</code></td>
</tr>
<tr class="even">
<td><code>list(1, 'a')</code></td>
<td><pre><code>[[1]]
[1] 1

[[2]]
[1] "a"
</code></pre></td>
</tr>
<tr class="odd">
<td>
<code>list(1, 'a',)</code> (<em>error!</em>)</td>
<td>
<code>[1] "list(1, 'a',)"</code> (<em>character</em>)</td>
</tr>
</tbody>
</table>
<p>But you’ll notice that a typo in our last example completely changed
the type of data that is read in. Depending on the way that you intend
to use this variable, perhaps this default is more error-prone than
necessary.</p>
<p>To help with this, there is a whole family of functions that allow
you to customize the way that environment variables are internalized as
option values (<code><a href="../reference/envvar_fns.html">?envvar_fns</a></code>). Generally, it’s best to keep
these specific to the data type of the option that you intend to use -
for example, using <code>envvar_is_true</code> to always coerce the
value to a logical scalar.</p>
<p>Just like before, these are used to specify your option’s
behaviors:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/defining_options.html">define_option</a></span><span class="op">(</span></span>
<span>  <span class="st">"volume"</span>,</span>
<span>  default <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  desc <span class="op">=</span> <span class="st">"Print output in uppercase (TRUE) or lowercase (FALSE)"</span>,</span>
<span>  envvar_fn <span class="op">=</span> <span class="fu"><a href="../reference/envvar_fns.html">envvar_is_true</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold; font-style: italic;">volume</span> = <span style="color: #0000BB; font-style: italic;">TRUE</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Print output in uppercase (TRUE) or lowercase (FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  <span style="color: #555555;"> </span>option <span style="color: #555555;"> : </span><span style="color: #00BBBB;">globalenv.volume</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;"> </span>envvar <span style="color: #555555;"> : </span><span style="color: #00BBBB;">GLOBALENV_VOLUME</span> (TRUE if one of 'TRUE', '1', FALSE otherwise)</span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">*</span><span style="color: #00BB00;">default</span><span style="color: #555555;"> : </span>TRUE</span></span></code></pre></div>
<p>Of course you can define this function however you like.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Let’s put it all together. We’ll customize our environment variable
name, and provide a custom <code>envvar_fn</code> which handles how we
interpret the raw environment variable value.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/defining_options.html">define_option</a></span><span class="op">(</span></span>
<span>  <span class="st">"volume"</span>,</span>
<span>  default <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  desc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">"Print output in uppercase (shout) or lowercase (whisper), or any "</span>,</span>
<span>    <span class="st">"number from 1-10 for random uppercasing"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  envvar_name <span class="op">=</span> <span class="st">"VOL"</span>,</span>
<span>  envvar_fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">raw</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">choice_of_nums</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envvar_fns.html">envvar_choice_of</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">raw</span>, shout <span class="op">=</span> <span class="fl">10</span>, whisper <span class="op">=</span> <span class="fl">1</span>, <span class="fu">choice_of_nums</span><span class="op">(</span><span class="va">raw</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold; font-style: italic;">volume</span> = <span style="color: #0000BB; font-style: italic;">1</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Print output in uppercase (shout) or lowercase (whisper), or any</span></span>
<span><span class="co">#&gt;   number from 1-10 for random uppercasing</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  <span style="color: #555555;"> </span>option <span style="color: #555555;"> : </span><span style="color: #00BBBB;">globalenv.volume</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;"> </span>envvar <span style="color: #555555;"> : </span><span style="color: #00BBBB;">VOL</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">*</span><span style="color: #00BB00;">default</span><span style="color: #555555;"> : </span>1</span></span></code></pre></div>
<blockquote>
<p>Note that the <code><a href="../reference/envvar_fns.html">?envvar_fns</a></code> family of functions, like
<code><a href="../reference/envvar_fns.html">envvar_choice_of()</a></code> return <em>functions</em>. Although this
is a very powerful mechanism of customizing behaviors, it can look odd
at first glance.</p>
<p>We first generate our function by giving it which values to choose
from (<code>envvar_choice_of(1:11)</code>), then use that function when
we have our raw value (<code>choice_of_nums(raw)</code>).</p>
</blockquote>
<p>Now we need to update our <code>twist_and</code> function to work
with our newly consistent numeric volumes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">twist_and_shout</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vol</span> <span class="op">=</span> <span class="fu"><a href="../reference/opt.html">opt</a></span><span class="op">(</span><span class="st">"volume"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lyric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Well, shake it up, baby, now (Shake it up, baby)"</span>,</span>
<span>    <span class="st">"Twist and shout (Twist and shout)"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># handle case where volume knob is broken</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">vol</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"someone turned off the stereo"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># randomly uppercase characters to match volume</span></span>
<span>  <span class="va">lyric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">lyric</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="va">lyric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lyric</span>, <span class="kw">function</span><span class="op">(</span><span class="va">line</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">char_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">line</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">(</span><span class="va">vol</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">9</span></span>
<span>    <span class="va">line</span><span class="op">[</span><span class="va">char_sample</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">line</span><span class="op">[</span><span class="va">char_sample</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">line</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># in case someone turns it up to 11</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">vol</span> <span class="op">==</span> <span class="fl">11</span><span class="op">)</span> <span class="va">lyric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(\\s*\\(|\\))"</span>, <span class="st">"!!!\\1"</span>, <span class="va">lyric</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">lyric</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Let’s try it out!</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>VOL <span class="op">=</span> <span class="st">"whisper"</span><span class="op">)</span></span>
<span><span class="fu">twist_and_shout</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; well, shake it up, baby, now (shake it up, baby)</span></span>
<span><span class="co">#&gt; twist and shout (twist and shout)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>VOL <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu">twist_and_shout</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; wELl, shakE it up, baby, NOw (ShAke it up, BAby)</span></span>
<span><span class="co">#&gt; tWIst and sHOut (twiSt aNd sHouT)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>VOL <span class="op">=</span> <span class="st">"shout"</span><span class="op">)</span></span>
<span><span class="fu">twist_and_shout</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; WELL, SHAKE IT UP, BABY, NOW (SHAKE IT UP, BABY)</span></span>
<span><span class="co">#&gt; TWIST AND SHOUT (TWIST AND SHOUT)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>VOL <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span><span class="fu">twist_and_shout</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; WELL, SHAKE IT UP, BABY, NOW!!! (SHAKE IT UP, BABY!!!)</span></span>
<span><span class="co">#&gt; TWIST AND SHOUT!!! (TWIST AND SHOUT!!!)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>VOL <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span>  <span class="co"># parsed as NULL</span></span>
<span><span class="fu">twist_and_shout</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in twist_and_shout(): someone turned off the stereo</span></span></code></pre></div>
<p>Looks pretty good! We handle just the inputs we want, without having
to worry about unexpected data slipping into our R code.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Doug Kelkhoff.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
